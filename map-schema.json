{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"title": "SillyTavern Interactive Map Schema",
	"description": "JSON Schema для валидации конфигурации интерактивной карты",
	"type": "object",
	"required": ["version", "metadata", "backgroundImage", "shapes"],
	"properties": {
		"version": {
			"type": "string",
			"description": "Версия карты в формате семантического версионирования",
			"pattern": "^\\d+\\.\\d+\\.\\d+$",
			"examples": ["1.0 Beta"]
		},
		"metadata": {
			"type": "object",
			"description": "Метаинформация о карте",
			"required": ["name", "author", "description"],
			"properties": {
				"name": {
					"type": "string",
					"description": "Отображаемое имя карты",
					"minLength": 1,
					"maxLength": 100,
					"examples": ["Willow Creek", "Wisteria Lane"]
				},
				"author": {
					"type": "string",
					"description": "Автор карты",
					"minLength": 1,
					"maxLength": 100,
					"examples": ["Pavel Orlov"]
				},
				"description": {
					"type": "string",
					"description": "Описание карты",
					"minLength": 1,
					"maxLength": 500,
					"examples": ["Интерактивная карта городка Willow Creek с кликабельными локациями"]
				},
				"created": {
					"type": "string",
					"description": "Дата создания",
					"format": "date",
					"examples": ["2025-11-01"]
				},
				"updated": {
					"type": "string",
					"description": "Дата последнего обновления",
					"format": "date",
					"examples": ["2025-11-04"]
				}
			},
			"additionalProperties": false
		},
		"backgroundImage": {
			"type": "object",
			"description": "Информация о фоновом изображении карты",
			"required": ["file", "width", "height"],
			"properties": {
				"file": {
					"type": "string",
					"description": "Путь к файлу изображения (относительно папки расширения)",
					"minLength": 1,
					"examples": ["maps/Willow Creek.png", "maps/WisteriaLane.png"]
				},
				"width": {
					"type": "integer",
					"description": "Ширина изображения в пиксельях",
					"minimum": 1,
					"examples": [1792]
				},
				"height": {
					"type": "integer",
					"description": "Высота изображения в пиксельях",
					"minimum": 1,
					"examples": [1024]
				},
				"alt": {
					"type": "string",
					"description": "Альтернативное текстовое описание изображения",
					"minLength": 1,
					"maxLength": 200,
					"examples": ["Карта Willow Creek"]
				}
			},
			"additionalProperties": false
		},
		"shapes": {
			"type": "array",
			"description": "Массив интерактивных локаций на карте",
			"minItems": 1,
			"items": {
				"type": "object",
				"description": "Интерактивная локация",
				"required": ["id", "type", "name", "tooltip", "path", "color", "script"],
				"properties": {
					"id": {
						"type": "string",
						"description": "Уникальный идентификатор локации",
						"pattern": "^[a-z0-9-]+$",
						"minLength": 1,
						"maxLength": 50,
						"examples": ["Willow Creek-player-house", "wisteria-garden"]
					},
					"type": {
						"type": "string",
						"description": "Тип локации для классификации",
						"enum": ["residence", "shop", "nature", "custom"],
						"examples": ["residence", "shop"]
					},
					"name": {
						"type": "string",
						"description": "Отображаемое имя локации",
						"minLength": 1,
						"maxLength": 100,
						"examples": ["Дом игрока", "Парк района"]
					},
					"tooltip": {
						"type": "string",
						"description": "Текст подсказки при наведении мыши",
						"minLength": 1,
						"maxLength": 200,
						"examples": ["Дом игрока - нажми для входа"]
					},
					"path": {
						"type": "string",
						"description": "SVG координаты контура локации",
						"pattern": "^[MmLlHhVvCcSsQqTtAaZz\\s\\d.,-]+$",
						"minLength": 5,
						"examples": ["M 150 500 L 193 385 L 261 345 L 330 400 Z"]
					},
					"color": {
						"type": "string",
						"description": "HEX цвет для подсвечивания при наведении",
						"pattern": "^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",
						"examples": ["#CC0000", "#0000CC", "#00CC00"]
					},
					"opacity": {
						"type": "number",
						"description": "Прозрачность подсвечивания (0.0-1.0)",
						"minimum": 0,
						"maximum": 1,
						"examples": [0.3, 0.5]
					},
					"script": {
						"type": "string",
						"description": "STScript команды, выполняемые при клике",
						"minLength": 1,
						"maxLength": 500,
						"examples": ["/go flux | /bg bedroom clean | /sys {{user}} возвращается домой"]
					}
				},
				"additionalProperties": false
			}
		}
	},
	"additionalProperties": false,
	"examples": [
		{
			"version": "1.0 Beta",
			"metadata": {
				"name": "Sample Map",
				"author": "Pavel Orlov",
				"description": "Пример интерактивной карты",
				"created": "2025-11-01",
				"updated": "2025-11-04"
			},
			"backgroundImage": {
				"file": "maps/Sample.png",
				"width": 1792,
				"height": 1024,
				"alt": "Карта примера"
			},
			"shapes": [
				{
					"id": "sample-house",
					"type": "residence",
					"name": "Дом",
					"tooltip": "Нажми для входа",
					"path": "M 100 100 L 200 100 L 200 200 L 100 200 Z",
					"color": "#CC0000",
					"opacity": 0.3,
					"script": "/go character | /bg bedroom | /sys {{user}} входит в дом"
				}
			]
		}
	]
}
